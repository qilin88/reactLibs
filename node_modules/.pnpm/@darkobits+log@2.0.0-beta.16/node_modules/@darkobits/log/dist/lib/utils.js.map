{"version":3,"sources":["../../src/lib/utils.ts"],"names":["create","Object","hasOwnProperty","prototype","isPrototypeOf","propertyIsEnumerable","toString","valueOf","toLocaleString","createOrphanedObject","obj","v","Reflect","apply","formatError","chalk","err","message","stack","split","os","EOL","pretty","slice","join","red","bold","rgb"],"mappings":";;;;;;;;AACA;;AAEA;;;;AAEA,MAAMA,MAAM,GAAGC,MAAM,CAACD,MAAtB;AACA,MAAME,cAAc,GAAGD,MAAM,CAACE,SAAP,CAAiBD,cAAxC;AACA,MAAME,aAAa,GAAGH,MAAM,CAACE,SAAP,CAAiBC,aAAvC;AACA,MAAMC,oBAAoB,GAAGJ,MAAM,CAACE,SAAP,CAAiBE,oBAA9C;AACA,MAAMC,QAAQ,GAAGL,MAAM,CAACE,SAAP,CAAiBG,QAAlC;AACA,MAAMC,OAAO,GAAGN,MAAM,CAACE,SAAP,CAAiBI,OAAjC;AACA,MAAMC,cAAc,GAAGP,MAAM,CAACE,SAAP,CAAiBK,cAAxC;;AAqBO,SAASC,oBAAT,GAAyC;AAE9C,QAAMC,GAAG,GAAGV,MAAM,CAAC,IAAD,CAAlB;;AAEAU,EAAAA,GAAG,CAACR,cAAJ,GAAqBS,CAAC,IAAIC,OAAO,CAACC,KAAR,CAAcX,cAAd,EAA8BQ,GAA9B,EAAmC,CAACC,CAAD,CAAnC,CAA1B;;AACAD,EAAAA,GAAG,CAACN,aAAJ,GAAoBO,CAAC,IAAIC,OAAO,CAACC,KAAR,CAAcT,aAAd,EAA6BM,GAA7B,EAAkC,CAACC,CAAD,CAAlC,CAAzB;;AACAD,EAAAA,GAAG,CAACL,oBAAJ,GAA2BM,CAAC,IAAIC,OAAO,CAACC,KAAR,CAAcR,oBAAd,EAAoCK,GAApC,EAAyC,CAACC,CAAD,CAAzC,CAAhC;;AACAD,EAAAA,GAAG,CAACF,cAAJ,GAAqB,MAAMI,OAAO,CAACC,KAAR,CAAcL,cAAd,EAA8BE,GAA9B,EAAmC,EAAnC,CAA3B;;AACAA,EAAAA,GAAG,CAACJ,QAAJ,GAAe,MAAMM,OAAO,CAACC,KAAR,CAAcP,QAAd,EAAwBI,GAAxB,EAA6B,EAA7B,CAArB;;AACAA,EAAAA,GAAG,CAACH,OAAJ,GAAc,MAAMK,OAAO,CAACC,KAAR,CAAcN,OAAd,EAAuBG,GAAvB,EAA4B,EAA5B,CAApB;;AAEA,SAAOA,GAAP;AACD;;AAGM,SAASI,WAAT,CAAqBC,KAArB,EAAmCC,GAAnC,EAA+C;AAAA;;AACpD,QAAMC,OAAO,GAAG,eAACD,GAAG,CAACE,KAAL,mDAAc,EAAd,EAAkBC,KAAlB,CAAwBC,YAAGC,GAA3B,EAAgC,CAAhC,CAAhB;AACA,QAAMH,KAAK,GAAG,wCAAWF,GAAG,CAACE,KAAf,qDAAwB,EAAxB,EAA4B;AAACI,IAAAA,MAAM,EAAE;AAAT,GAA5B,EAA4CH,KAA5C,CAAkDC,YAAGC,GAArD,EAA0DE,KAA1D,CAAgE,CAAhE,EAAmEC,IAAnE,CAAwEJ,YAAGC,GAA3E,CAAd;AAEA,SAAO,CACLN,KAAK,CAACU,GAAN,CAAUC,IAAV,CAAeT,OAAf,CADK,EAELF,KAAK,CAACY,GAAN,CAAU,EAAV,EAAc,EAAd,EAAkB,EAAlB,EAAsBT,KAAtB,CAFK,EAGLM,IAHK,CAGAJ,YAAGC,GAHH,CAAP;AAID","sourcesContent":["/* eslint-disable @typescript-eslint/unbound-method */\nimport os from 'os';\nimport {Chalk} from 'chalk';\nimport cleanStack from 'clean-stack';\n\nconst create = Object.create;\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\nconst isPrototypeOf = Object.prototype.isPrototypeOf;\nconst propertyIsEnumerable = Object.prototype.propertyIsEnumerable;\nconst toString = Object.prototype.toString;\nconst valueOf = Object.prototype.valueOf;\nconst toLocaleString = Object.prototype.toLocaleString;\n\n\ninterface OrphanedObject {\n  [key: string]: any;\n  hasOwnProperty: typeof Object['prototype']['hasOwnProperty'];\n  isPrototypeOf: typeof Object['prototype']['isPrototypeOf'];\n  propertyIsEnumerable: typeof Object['prototype']['propertyIsEnumerable'];\n  toLocaleString: typeof Object['prototype']['toLocaleString'];\n  toString: typeof Object['prototype']['toString'];\n  valueOf: typeof Object['prototype']['valueOf'];\n}\n\n\n/**\n * Creates a new object of type T with no prototype.\n *\n * Designed to partially mitigate attacks like these:\n *\n * https://snyk.io/vuln/npm:lodash:20180130\n */\nexport function createOrphanedObject<T = any>() {\n  // eslint-disable-next-line unicorn/no-null\n  const obj = create(null) as T & OrphanedObject; // tslint:disable-line no-null-keyword\n\n  obj.hasOwnProperty = v => Reflect.apply(hasOwnProperty, obj, [v]);\n  obj.isPrototypeOf = v => Reflect.apply(isPrototypeOf, obj, [v]);\n  obj.propertyIsEnumerable = v => Reflect.apply(propertyIsEnumerable, obj, [v]);\n  obj.toLocaleString = () => Reflect.apply(toLocaleString, obj, []);\n  obj.toString = () => Reflect.apply(toString, obj, []);\n  obj.valueOf = () => Reflect.apply(valueOf, obj, []);\n\n  return obj as T;\n}\n\n\nexport function formatError(chalk: Chalk, err: Error) {\n  const message = (err.stack ?? '').split(os.EOL)[0];\n  const stack = cleanStack(err.stack ?? '', {pretty: true}).split(os.EOL).slice(1).join(os.EOL);\n\n  return [\n    chalk.red.bold(message),\n    chalk.rgb(85, 85, 85)(stack)\n  ].join(os.EOL);\n}\n"],"file":"utils.js"}