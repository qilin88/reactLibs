"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = SpinnerFactory;

var _cliSpinners = _interopRequireDefault(require("cli-spinners"));

var _deepmerge = _interopRequireDefault(require("deepmerge"));

var _ow = _interopRequireDefault(require("ow"));

var _utils = require("./utils");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const DEFAULT_OPTIONS = {
  name: 'dots'
};

function SpinnerFactory(userSpinnerOptions = {}) {
  const spinner = (0, _utils.createOrphanedObject)();
  const spinnerOptions = (0, _deepmerge.default)(DEFAULT_OPTIONS, userSpinnerOptions);
  (0, _ow.default)(spinnerOptions.name, 'spinner name', _ow.default.string);
  const spinnerInfo = _cliSpinners.default[spinnerOptions.name];

  if (!spinnerInfo) {
    throw new Error(`Invalid spinner name: "${spinnerOptions.name}".`);
  }

  const startTime = Date.now();
  const {
    frames,
    interval
  } = spinnerInfo;

  spinner.toString = () => {
    const timeElapsed = Date.now() - startTime;
    const curFrame = Math.floor(timeElapsed / interval) % frames.length;
    return frames[curFrame];
  };

  return spinner;
}

module.exports = exports.default;
//# sourceMappingURL=spinner.js.map